<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <!-- https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP -->
    <title>Frankenplayer</title>
  </head>
  <body style="overflow:hidden;">
    <div class="main">
      <video id="main-video" class="video-js" style="width:100%;height:100%;"></video>
    </div>
  </body>
  <script src="./MediaPlayer.js"></script>
  <script>

    let videoPlayer;

    window.onload = async () => {
      videoPlayer = new Player('#main-video', {'autoplay': true, 'loop': true});
      videoPlayer.setVolume(0.0);
      setInterval(() => {
        let currentTime = videoPlayer.getCurrentTime();
        window.bridge.setCurrentTime(currentTime);
      }, 100);
    }

    const loadContent = (c) => {
      console.log(c);
      videoPlayer.setSrc(c);
    }

    const processCommand = (m) => {
      switch(m) {
        case 'play': 
          videoPlayer.play();
          break;  
        case 'pause':
          videoPlayer.pause();
          break;
        default:
          console.log(m);
      }
    }

    window.bridge.loadContent((e, c) => {
      loadContent(c);
    })

    window.bridge.command((e, m) => {
      processCommand(m);
    })

  </script>
</html> 